<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Tauri + Yew App</title>
    <link data-trunk rel="css" href="styles.css" />
    <link data-trunk rel="copy-dir" href="public" />
    <script type="module">
      let checkUpdate = window.__TAURI__.updater.checkUpdate;
      let installUpdate = window.__TAURI__.updater.installUpdate;
      let onUpdaterEvent = window.__TAURI__.updater.onUpdaterEvent;
      let relaunch = window.__TAURI__.relaunch;

      const unlisten = await onUpdaterEvent(({ error, status }) => {
        // This will log all updater events, including status updates and errors.
        console.log('Updater event', error, status)
      })

      try {
        const { shouldUpdate, manifest } = await checkUpdate()

        if (shouldUpdate) {
          // You could show a dialog asking the user if they want to install the update here.
          console.log(
            `Installing update ${manifest?.version}, ${manifest?.date}, ${manifest?.body}`
          )

          // Install the update. This will also restart the app on Windows!
          await installUpdate()

          // On macOS and Linux you will need to restart the app manually.
          // You could use this step to display another confirmation dialog.
          await relaunch()
        }
      } catch (error) {
        console.error(error)
      }

      // you need to call unlisten if your handler goes out of scope, for example if the component is unmounted.
      unlisten();
</script>
  </head>
  <body></body>
</html>
